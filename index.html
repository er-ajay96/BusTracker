
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transformer GIS Map</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body { margin:0; font-family: Arial, sans-serif; }
#map { height: calc(100vh - 50px); width: 100%; }

.topbar {
  display:flex;
  gap:8px;
  padding:6px;
  background:#f1f5f9;
}
.topbar input {
  flex:1;
  padding:6px;
}
.topbar button {
  padding:6px 10px;
  cursor:pointer;
}

.label {
  font-size:11px;
  font-weight:bold;
  background:white;
  padding:2px 4px;
  border-radius:4px;
  box-shadow:0 0 3px rgba(0,0,0,0.4);
}
</style>
</head>
<body>

<div class="topbar">
  <input type="text" id="searchBox" placeholder="üîç Search Transformer / ID">
  <button onclick="printMap()">üìÑ Print / PDF</button>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* ---------------- MAP ---------------- */
const map = L.map('map').setView([31.60, 76.96], 12);

const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19
}).addTo(map);

const satellite = L.tileLayer(
  'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
  { maxZoom: 19 }
);

L.control.layers(
  { "üó∫Ô∏è Map": osm, "üõ∞Ô∏è Satellite": satellite }
).addTo(map);

/* ---------------- ICONS BY KVA ---------------- */
function icon(color){
  return L.divIcon({
    html:`<div style="background:${color};width:14px;height:14px;border-radius:50%;border:2px solid white"></div>`
  });
}
const kvaIcon = {
  25: icon("green"),
  63: icon("blue"),
  100: icon("orange"),
  250: icon("red")
};

/* ---------------- DATA ---------------- */
const locations = [
  { lat:31.6054808, lng:76.9639604, label:"100 KVA stoh 2nd-1315410314647", kva:100 },
  { lat:31.6098588, lng:76.9599462, label:"25 KVA Stoh 3rd-1315410314546", kva:25 },
  { lat:31.5872733, lng:76.9701150, label:"250 KVA khiuri 1st-1315410315657", kva:250 },
  { lat:31.5907910, lng:76.9516289, label:"63 KVA Bhura 4th-1315410315556", kva:63 },
  { lat:31.5998891, lng:76.9557079, label:"100 KVA stoh 4th-1315410315354", kva:100 },
  { lat:31.6048573, lng:76.9594451, label:"100 KVA stoh 1st-1315410315051", kva:100 },
  { lat:31.6088808, lng:76.9531359, label:"63 KVA Ghatta 3rd-1315410314445", kva:63 },
  { lat:31.6015198, lng:76.9668138, label:"25 KVA barshala-1315410314849", kva:25 },
  { lat:31.5947936, lng:76.9573090, label:"25 KVA KEHAD 2ND-1315410313334", kva:25 },
  { lat:31.5915190, lng:76.9618198, label:"63 KVA NALSAR BHIURA-1315410313637", kva:63 },
  { lat:31.5887108, lng:76.9541419, label:"63 KVA BHIURA 3RD-1315410313839", kva:63 },
  { lat:31.6006359, lng:76.9493730, label:"100 KVA BHIURA 1ST-1315410314041", kva:100 },
  { lat:31.5830256, lng:76.9662600, label:"25 KVA KHURI-1315410312122", kva:25 },
  { lat:31.5840843, lng:76.9677875, label:"250 KVA KANGRU-1315410312223", kva:250 },
  { lat:31.5826247, lng:76.9675612, label:"25 KVA JIO MANDIR KANDLOO-1315410312324", kva:25 },
  { lat:31.5915517, lng:76.9597925, label:"25 KVA CHATYARA-1315410313738", kva:25 },
  { lat:31.5922828, lng:76.9703533, label:"25 KVA BHARTI AIRTEL BAN LOG TOWER-1315410312526", kva:25 },
  { lat:31.5997403, lng:76.9780508, label:"63 KVA PIPALOO-1315410312930", kva:63 },
  { lat:31.6043092, lng:76.9710922, label:"63 KVA CHWARI-1315410313031", kva:63 },
  { lat:31.5946041, lng:76.9630319, label:"100 KVA KEHAD 1ST-1315410313233", kva:100 },
  { lat:31.6042353, lng:76.9490378, label:"100 KVA G.H.A GHADROUR-1315410314142", kva:100 },
  { lat:31.6124838, lng:76.9512566, label:"63 KVA LWSS GHAMBER KHAD-1315410413738", kva:63 },
  { lat:31.6134075, lng:76.9496180, label:"25 KVA RELIANCE JIO GHATTA-1315410314243", kva:25 },
  { lat:31.5953240, lng:76.9759677, label:"25 KVA CHAWARI AT RIGGER-1315410312728", kva:25 },
  { lat:31.5965985, lng:76.9695887, label:"100 KVA RAJGARH 1ST-1315410313132", kva:100 },
  { lat:31.6096476, lng:76.9491654, label:"100 KVA GHATTA 2ND-1315410314344", kva:100 },
  { lat:31.5671467, lng:76.9628967, label:"25 KVA LOHARDI KOT-1315410311920", kva:25 },
  { lat:31.5686417, lng:76.9646700, label:"63 KVA SURANDI KOT-1315410312021", kva:63 },
  { lat:31.5973463, lng:76.9749273, label:"63 KVA KEHD STOH RIGGAR PUMP-1315410315455", kva:63 },
  { lat:31.6039864, lng:76.9643332, label:"63 KVA RIGGER PUMP-1315410314748", kva:63 },
  { lat:31.5984543, lng:76.9430759, label:"63 KVA T-5 (KUMMI PUMP)-1315410412930", kva:63 },
  { lat:31.6018749, lng:76.9427117, label:"63 KVA 22/0.4 KV T6-1315410413233", kva:63 },
  { lat:31.6106165, lng:76.9469820, label:"100 KVA KATHYAL CHATARU PUMP-1315410413637", kva:100 },
  { lat:31.5984997, lng:76.9430075, label:"63 KVA BHIURA 5TH-1315410413031", kva:63 },
  { lat:31.5992968, lng:76.9400005, label:"100 KVA BHIURA 2ND-1315410413132", kva:100 },
  { lat:31.6127261, lng:76.9451170, label:"100 KVA CHALI (KUMMI 5)-1315410413435", kva:100 },
  { lat:31.6148058, lng:76.9483467, label:"100 KVA CHATARU-1315410413536", kva:100 },
  { lat:31.6087095, lng:76.9459905, label:"63 KVA KHATHYAL-1315410413334", kva:63 }
];

/* ---------------- MARKERS ---------------- */
const markers = [];

locations.forEach(l => {
  const m = L.marker([l.lat,l.lng],{icon:kvaIcon[l.kva]}).addTo(map);
  m.bindPopup(`
    <b>${l.label}</b><br>
    üîã ${l.kva} KVA<br><br>
    <button onclick="navigate(${l.lat},${l.lng})">üß≠ Navigate</button>
  `);
  m.bindTooltip(`<div class="label">${l.label}</div>`,
    {permanent:true,direction:"top",offset:[0,-8]}
  );
  markers.push({marker:m,text:l.label.toLowerCase()});
});

map.fitBounds(markers.map(m=>m.marker.getLatLng()));

/* ---------------- SEARCH ---------------- */
document.getElementById("searchBox").addEventListener("input",e=>{
  const q=e.target.value.toLowerCase();
  markers.forEach(m=>{
    if(m.text.includes(q)){
      m.marker.addTo(map);
    } else {
      map.removeLayer(m.marker);
    }
  });
});

/* ---------------- PRINT / PDF ---------------- */
function printMap(){
  window.print();
}

/* ---------------- NAVIGATION ---------------- */
function navigate(lat,lng){
  const url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`;
  window.open(url,'_blank');
}

</script>
</body>
</html>
